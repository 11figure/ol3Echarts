{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 29714f6362a9bb7b09f3","webpack:///external \"echarts\"","webpack:///./src/layer/echartsLayer.js","webpack:///./src/registerMap/registerMap.js","webpack:///./src/index.js","webpack:///./src/registerMap/registerMapCoordSys.js","webpack:///./src/registerMap/registerMapModel.js","webpack:///./src/registerMap/registerMapView.js"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA,+C;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA;;;;;;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,gCAAgC;AACnC;AACA;AACA;AACA,CAAC;AAAA;;;;;;;AClBD;AACA;AACA;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,CAAC;AAAA;;;;;;;kCC7GD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH,CAAC;AAAA;;;;;;;kCCVD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;AAAA","file":"ol3Echarts.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"echarts\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"echarts\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ol3Echarts\"] = factory(require(\"echarts\"));\n\telse\n\t\troot[\"ol3Echarts\"] = factory(root[\"echarts\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 29714f6362a9bb7b09f3","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"echarts\"\n// module id = 0\n// module chunks = 0","var echarts = require('echarts')\r\n/**\r\n * 创建独立对象\r\n * @param map\r\n */\r\nvar ol3Echarts = function (map, container) {\r\n  this.map = map\r\n  var size = this.map.getSize()\r\n  var div = document.createElement('div')\r\n  div.style.position = 'absolute'\r\n  div.style.height = size[1] + 'px'\r\n  div.style.width = size[0] + 'px'\r\n  div.style.top = 0\r\n  div.style.left = 0\r\n  if (container && container.indexOf('.') === 0) {\r\n    var _container = this.getElementsByClassName(container, window)\r\n    _container.appendChild(div)\r\n  } else if (container && container.indexOf('#') === 0) {\r\n    var _con = (typeof id === 'string' ? document.getElementById(id) : id);\r\n    _con.appendChild(div)\r\n  } else {\r\n    this.map.getViewport().appendChild(div)\r\n  }\r\n  this._echartsContainer = div\r\n  this.chart = echarts.init(div)\r\n  if (!echarts) {\r\n    throw new Error('请先引入echarts3！')\r\n  }\r\n  echarts.Map = map\r\n  this.resize()\r\n}\r\n\r\n/**\r\n * 通过类名获取元素\r\n * @param str\r\n * @param root\r\n * @returns {HTMLElement}\r\n */\r\nol3Echarts.prototype.getElementsByClassName = function (str, root) {\r\n  var _root = root || window\r\n  var $ = _root.document.querySelector.bind(_root.document)\r\n  var target = $(str)\r\n  return target\r\n}\r\n\r\n/**\r\n * 移除echarts\r\n */\r\nol3Echarts.prototype.remove = function () {\r\n  this._echartsContainer.parentNode.removeChild(this._echartsContainer)\r\n  this.map = undefined\r\n  echarts.Map = undefined\r\n}\r\n/**\r\n * 响应地图尺寸变化\r\n */\r\nol3Echarts.prototype.resize = function () {\r\n  var that = this\r\n  var size = this.map.getSize()\r\n  that._echartsContainer.style.width = size[0] + 'px'\r\n  that._echartsContainer.style.height = size[1] + 'px'\r\n  var resizeEvt = (('orientationchange' in window) ? 'orientationchange' : 'resize')\r\n  var doc = window.document;\r\n  window.addEventListener(resizeEvt, function() {\r\n    setTimeout(function () {\r\n      that.chart.resize()\r\n    }, 50)\r\n  }, false);\r\n  window.addEventListener('pageshow', function(e) {\r\n    if (e.persisted) {\r\n      setTimeout(function () {\r\n        that.chart.resize()\r\n      }, 50)\r\n    }\r\n  }, false);\r\n  if (doc.readyState === 'complete') {\r\n    setTimeout(function () {\r\n      that.chart.resize()\r\n    }, 50)\r\n  } else {\r\n    doc.addEventListener('DOMContentLoaded', function(e) {\r\n      setTimeout(function () {\r\n        that.chart.resize()\r\n      }, 50)\r\n    }, false);\r\n  }\r\n}\r\n\r\nmodule.exports = ol3Echarts\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/layer/echartsLayer.js\n// module id = 1\n// module chunks = 0","/**\r\n * Created by FDD on 2017/5/30.\r\n * @desc 注册当前地图的坐标系统,事件，模块和视图\r\n */\r\ndefine(function (require) {\r\n  require('echarts').registerCoordinateSystem(\r\n    'HMap', require('./registerMapCoordSys')\r\n  )\r\n  require('./registerMapModel')\r\n  require('./registerMapView')\r\n  require('echarts').registerAction({\r\n    type: 'MapRoam',\r\n    event: 'MapRoam',\r\n    update: 'updateLayout'\r\n  }, function (payload, ecModel) {})\r\n  return {\r\n    version: '1.2.0'\r\n  }\r\n})\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/registerMap/registerMap.js\n// module id = 2\n// module chunks = 0","require('./registerMap/registerMap.js')\r\nvar ol3Echarts = require('./layer/echartsLayer.js')\r\nmodule.exports = ol3Echarts\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 3\n// module chunks = 0","/**\r\n * Created by FDD on 2017/5/30.\r\n * @desc 坐标系统\r\n */\r\ndefine(function (require) {\r\n  var echarts = require('echarts')\r\n  var CoordSys = function (mapInstance, api) {\r\n    this.Map = mapInstance\r\n    this.dimensions = ['lng', 'lat']\r\n    this._mapOffset = [0, 0]\r\n    this._api = api\r\n  }\r\n\r\n  CoordSys.prototype.dimensions = ['lng', 'lat']\r\n\r\n  /**\r\n   * 设置地图窗口的偏移\r\n   * @param mapOffset\r\n   */\r\n  CoordSys.prototype.setMapOffset = function (mapOffset) {\r\n    this._mapOffset = mapOffset\r\n  }\r\n\r\n  /**\r\n   * 获取地图对象\r\n   * @returns {*|ol.Map}\r\n   */\r\n  CoordSys.prototype.getBMap = function () {\r\n    return this.Map\r\n  }\r\n\r\n  /**\r\n   * 设置当前地图\r\n   * @param map\r\n   */\r\n  CoordSys.prototype.setMap = function (map) {\r\n    if (map && map instanceof ol.Map) {\r\n      this.Map = map\r\n    } else {\r\n      throw new Error('传入的不是地图对象！')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 跟据坐标转换成屏幕像素\r\n   * @param coords\r\n   * @returns {ol.Pixel}\r\n   */\r\n  CoordSys.prototype.dataToPoint = function (coords) {\r\n    if (coords && Array.isArray(coords) && coords.length > 0) {\r\n      coords = coords.map(function (item) {\r\n        if (typeof item === 'string') {\r\n          item = Number(item)\r\n        }\r\n        return item\r\n      })\r\n    }\r\n    return this.Map.getPixelFromCoordinate(ol.proj.fromLonLat(coords))\r\n  }\r\n\r\n  /**\r\n   * 跟据屏幕像素转换成坐标\r\n   * @param pixel\r\n   * @returns {ol.Coordinate}\r\n   */\r\n  CoordSys.prototype.pointToData = function (pixel) {\r\n    return this.Map.getCoordinateFromPixel(pixel)\r\n  }\r\n\r\n  /**\r\n   * 获取视图矩形范围\r\n   * @returns {*}\r\n   */\r\n  CoordSys.prototype.getViewRect = function () {\r\n    var api = this._api\r\n    return new echarts.graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\r\n  }\r\n\r\n  /**\r\n   * 移动转换\r\n   */\r\n  CoordSys.prototype.getRoamTransform = function () {\r\n    return echarts.matrix.create()\r\n  }\r\n\r\n  CoordSys.dimensions = CoordSys.prototype.dimensions\r\n\r\n  /**\r\n   * 注册实例\r\n   * @param echartModel\r\n   * @param api\r\n   */\r\n  CoordSys.create = function (echartModel, api) {\r\n    var _coordSys = null\r\n    echartModel.eachComponent('HMap', function (MapModel) {\r\n      var _HMap = echarts.Map\r\n      _coordSys = new CoordSys(_HMap, api)\r\n      _coordSys.setMapOffset(MapModel.mapOffset || [0, 0])\r\n      MapModel.coordinateSystem = _coordSys\r\n    })\r\n\r\n    echartModel.eachSeries(function (seriesModel) {\r\n      if (seriesModel.get('coordinateSystem') === 'HMap') {\r\n        seriesModel.coordinateSystem = _coordSys\r\n      }\r\n    })\r\n  }\r\n\r\n  return CoordSys\r\n})\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/registerMap/registerMapCoordSys.js\n// module id = 4\n// module chunks = 0","define(function (require) {\r\n  return require('echarts').extendComponentModel({\r\n    type: 'HMap',\r\n    getBMap: function () {\r\n      return this.Map\r\n    },\r\n    defaultOption: {\r\n      roam: false\r\n    }\r\n  })\r\n})\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/registerMap/registerMapModel.js\n// module id = 5\n// module chunks = 0","define(function (require) {\r\n  var echarts = require('echarts')\r\n  return echarts.extendComponentView({\r\n    type: 'HMap',\r\n    render: function (MapModel, echartModel, api) {\r\n      var rendering = true\r\n      var Map = echarts.Map\r\n      var viewportRoot = api.getZr().painter.getViewportRoot()\r\n      var coordSys = MapModel.coordinateSystem\r\n      var moveHandler = function (type, target) {\r\n        if (rendering) {\r\n          return\r\n        }\r\n        var offsetEl = viewportRoot.parentNode.parentNode.parentNode\r\n        var mapOffset = [\r\n          -parseInt(offsetEl.style.left, 10) || 0,\r\n          -parseInt(offsetEl.style.top, 10) || 0\r\n        ]\r\n        viewportRoot.style.left = mapOffset[0] + 'px'\r\n        viewportRoot.style.top = mapOffset[1] + 'px'\r\n        coordSys.setMapOffset(mapOffset)\r\n        MapModel.mapOffset = mapOffset\r\n        api.dispatchAction({\r\n          type: 'MapRoam'\r\n        })\r\n      }\r\n      var zoomEndHandler = function () {\r\n        if (rendering) {\r\n          return\r\n        }\r\n        api.dispatchAction({\r\n          type: 'MapRoam'\r\n        })\r\n      }\r\n      this._oldMoveHandler = moveHandler\r\n      this._oldZoomEndHandler = zoomEndHandler\r\n      Map.getView().on('change:resolution', moveHandler)\r\n      Map.getView().on('change:center', moveHandler)\r\n      Map.getView().on('change:rotation', moveHandler)\r\n      Map.on('moveend', moveHandler)\r\n      var roam = MapModel.get('roam')\r\n      if (roam && roam !== 'scale') {\r\n        // todo 允许拖拽\r\n      } else {\r\n        // todo 不允许拖拽\r\n      }\r\n      if (roam && roam !== 'move') {\r\n        // todo 允许移动\r\n      } else {\r\n        // todo 不允许允许移动\r\n      }\r\n      rendering = false\r\n    }\r\n  })\r\n})\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/registerMap/registerMapView.js\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}